---
import { defineCollection, getCollection } from "astro:content";
import { Image } from "astro:assets";

import Layout from "@/layouts/Layout.astro";
import SocialLinks from "@/components/SocialLinks.astro";
import ProjectCard from "@/components/ProjectCard.astro";
import Link from "@/components/shared/Link.astro";
import convertAsteriskToStrongTag from "@/utils/convertAsteriskToStrongTag";

import presentation from "@/data/presentation";
import projects from "@/data/projects";
import experiences from "@/data/experiences";
import type { Code, Debug } from "astro:components";
import Experience from "@/components/Experience.astro";
import type { ViewTransitions, fade } from "astro:transitions";
import type { defineMiddleware } from "astro:middleware";

const posts = (await getCollection("posts")).sort(function (first, second) {
  return second.data.publishedAt.getTime() - first.data.publishedAt.getTime();
});
---

<Layout>
  <div id="main-content">
    <main class="flex flex-col gap-20">
      <article
        class="flex flex-col gap-8 md:flex-row-reverse md:justify-end md:gap-12"
      >
        {
          presentation.profile && (
            <Image
              src={presentation.profile}
              class="w-1/4 self-center rounded-full"
              alt="Your Profile"
              width="200"
              height="200"
            />
          )
        }

        <div class="flex flex-col gap-8">
          <h1 class="text-3xl text-neutral-100">
            {presentation.title}
          </h1>

          <h2
            class="w-auto max-w-[60ch] leading-6"
            set:html={convertAsteriskToStrongTag(presentation.description)}
          />

          <SocialLinks />
        </div>
      </article>

      <article class="flex flex-col gap-8">
        <header class="flex w-full flex-row justify-between gap-2">
          <h3 class="text-lg text-neutral-100">
            Experience ({experiences.length})
          </h3>
        </header>

        <section class="flex flex-col gap-4">
          {
            experiences.length === 0 ? (
              <p>No experiences listed yet.</p>
            ) : (
              experiences.map((experience) => <Experience {...experience} />)
            )
          }
        </section>
      </article>

      <article class="flex flex-col gap-8">
        <header class="flex w-full flex-row justify-between gap-2">
          <h3 class="text-lg text-neutral-100">
            Projects ({projects.length})
          </h3>
        </header>
        {projects.length === 0 && <p>Oops, I must work^^^^^</p>}

        <section class="flex flex-col gap-4">
          {
            projects.length !== 0 &&
              projects.map((project) => <ProjectCard {...project} />)
          }
        </section>
      </article>

      <!-- <article class="flex flex-col gap-8">
        <header class="flex w-full flex-row justify-between gap-2">
          <h3 class="text-lg text-neutral-100">Get in touch</h3>
        </header>
        <p>
          Email me at <Link
            href={`mailto:${presentation.mail}`}
            label={presentation.mail}
          /> or follow me via my social links.
        </p>

        <SocialLinks />
      </article> -->
      <a
        href="https://github.com/MaeWolff/astro-portfolio-template"
        class="inline-flex items-center text-neutral-400 hover:text-neutral-100"
      >
        Build with
        <span class="flex items-center ml-1">
          Astro
          <img
            src="https://astro.js.org/astro.png"
            alt="Astro Logo"
            class="mt-1 h-6 w-6 "
          />
        </span>, Template adapted from MaeWolff's Astro Portfolio Template
      </a>
    </main>
  </div>
</Layout>
